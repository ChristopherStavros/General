# CM Pivot

- "Favorites" added in 1810
- Create collection - creates static collections
- "Community Help"? "Community Hub"? coming
- Uses cached data - so reopen CMpivot console if needed
- 1806 - 25 entities
- 1810 - 100
- 1902 - like 125

- Get a signing certificate
  - Sign your scripts


# Scripts

- "Edit an existing script" - 1902
- Scripts are stored in SQL
- param([string]$value)

## Entities

- Example - SMBConfig/EnableSMB1Protocol
- Port 10123, fallback to HTTP(s)
- Client always initiates communications
  - Stateful packet Firewall
- Dynamic DNS?

# Client Notification

- RCTs require that you are local admin on a system
- TCP channel keep alive 5 minute - stateful packet firewall (or 15 minutes?)

# CMG calculator in new TPs

- Pennies per client per month that connect

# Collection extensible data from clients

# Stuff

- State messages
  - New in 1810 Improved State Message Processing (MPE) - bypassing inboxes
- CMPivot and scripts are more or less the same feature
- Ephgrave wrote a blog a couple weeks ago - CMpivot, scripts

# Scripts

- Run a local systems
- Retries for 60 seconds -- then will time out....
- Real time
- Use client notification

# Data usage

- KB per client usually but could be more - depending...

# Azure Log and Analytics SQL Language (KQL - Kusto Query Language)

- System Center dudes
  - Blog with many queries

- [Pluralsight - Free Course](https://www.pluralsight.com/courses/kusto-query-language-kql-from-scratch)

# Pointy haired boss?  

Registry("HKLM:\\Software\\Test")

# Parameters for scripts

# Gotchas

- Script signing
- PowerShell constrained language mode
- PS version (>3.0), exectionpolicy, etc.


